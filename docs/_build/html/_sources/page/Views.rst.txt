============
View's
============


Participant View
----------------

дописать описание

.. image:: /_static/Images/Figure_9.png
   :target: ../../_static/Images/Figure_9.png

*Participant View Page Interface*

    1. краткая учетная информация пользователя, так же содежит ссылку на групп въю
    2. выбор study к группе которого привязан пользователь
    3. выбор координатора группы к которой привязан пользоватеоей
    4. список всех партиципантов выбранного клинишина в данной стади
    5. выбор временного периода для отображения данных
    6. график веса, полученного от фитбит
    7. график еды, полученной от фитбита. Так же есть возможность просмотреть детализированный лог еды за этот день по щелчку на соответсвующем дне графика. (ниже картинка)
    8. график активности полученный от фитбита. Так же есть возможность просмотреть детализированный лог активности за этот день по щелчку на соответсвующем дне графика. (ниже картинка)
    9. ссылка на настройки интервеншенов
    10. поиск по таблице интервеншенов
    11. таблица интервеншенов
    12. ссылка на обработку интервеншена, с пометкой о том был ли обработан интервеншен (зеленое) или нет (красное)


.. image:: /_static/Images/Figure_10.png
   :target: ../../_static/Images/Figure_10.png

*Окно с детальным логом еды, вызванное при клике на графике калорий*

.. image:: /_static/Images/Figure_11.png
   :target: ../../_static/Images/Figure_11.png

*Окно с детальным логом активности, вызванное при клике на графике активности*

Study Coordinator View
----------------------

Страница содержит  агрегированные данные полученные от фитбита, а также интервеншенах пользователя.

.. note:: Данные выбираются для периода выбранного в элементах управления страницей, по умолчанию это период начинающийся с даты месяц назад и текущей датой.

Все данные представлены в виде трех таблиц:
    * **Average data**
    * **Block data**
    * **Raw data**

Таблица **Average Data** – содержит данные общие данные о интервеншенах пользователя.

Колонки таблицы **Average Data**:
    * **Intervention** - тип *Intervention*
    * **Cost** - относительная стоимость *Intervention*, настраивается на странице Edit study (link)
    * **Count** - Количество *интервеншенов* этого типа
    * **RsAvg** - средний RS *интервеншенов* этого типа), данные значения должны соответсвовать данным для расчета в expression для групп с групповой оптимизацией, а также отображаемые на странице Group View (для корректного отображения должнен быть выбран период охватывающий все интервеншены)
    * **WeightedRsAvg** - среднее значение **(DecayWeight ^ Number)** *интервеншенов* этого типа, где **DecayWeight** константа, настраивается на странице Edit study(link), Number – порядковый номер каждого интервеншена отсортированного по дате в порядке убывания начиная с нуля.

Таблица **Block data** - список *интервеншенов* с соответсвубщими им временными периодами (блоками), с общими данными для каждого.

Колонки таблицы **Block data**:
    * **Date** - дата *intervention*
    * **Duration** - длительность *intervention* в целых днях, начиная с даты *intervention* назад, включительно. (Например intervention 10/27/2017 и длительностью 4 включает 4 дня: 10/27/2017, 10/26/2017 , 10/25/2017 , 10/24/2017)
    * **Weekend Days** - количество дней которые пришлись на выходные
    * **Intervention** - тип *intervention*
    * **RS** - reward score для этого *intervention* (средний RS среди всех дней связанного периода), данные значения должны соответсвовать данным для расчета в expression для групп с индивидуальной оптимизацией (для корректного отображения должнен быть выбран период охватывающий все интервеншены)
    * **Weight (for RS)** - соответсвует **WeightedRsAvg** из таблицы *Average Data*, но для конкретного *Intervention*

Таблица **Raw data** - агрегированные по дням данные полученные от фитбита.

.. note:: Данные указываются только для тех дней для оторых получены хоть какие то данные.

Колонки таблицы **Raw Data**:
    * **Date** – дата за каторую агрегируются данные
    * **Weight** – последний вес полученный от фитбит
    * **Food logged** – количество еды (записей) полученных от фитбит
    * **Food calories logged** – суммарная калорийность еды полученной от фитбит
    * **Calories goal** – цель по калориям, устанавливается в настройках *Study* к группе которого привязан пользователь
    * **Steps** – количество шагов полученных в активности от фитбит
    * **Steps goal** - цель по шагам, устанавливается в настройках *Study* к группе которого привязан пользователь
    * **Activity minutes** – сумма минут активности полученных в активности от фитбит
    * **Activity minutes goal** - цель по минутам активности, устанавливается в настройках *Study* к группе которого привязан пользователь
    * **PA goal freq** – устнавливается значение 1 если в этот день данные по активности не равны нулю, тип активности выбирается в зависимости от значения **StudyAlgorithm** (устанавливается в настройках *Study* к группе которого привязан пользователь)
    * **Weight freq** – устанавливается значение 1 если данные по весу за этот день больше нуля
    * **Food trak freq** – устанавливается значение 1 если количество записей еды за этот день больше нуля
    * **Cal goal freq** – устанавливается значение 1 если сумма калорий всех записей еды за этот день находится в промежутке между **Minimum Reported Calories** и **Calories Goal**, **Minimum Reported Calories** устанавливается в настройках Study к группе которого привязан пользователь
    * **Weight Loss (1 day)** -  потеря веса за этот день (относительно предыдущего дня, 0 если нет данных за этот день)
    * **Weight Loss (7 day)** -  потеря веса за эту неделю (относительно даты неделю назад, 0 если нет данных за этот день)
    * **Weight Loss (14 day)** -  потеря веса за две недели (относительно даты две недели назад, 0 если нет данных за этот день)
    * **RS** – Rs за этот день, данное значение хранится в базе данных и обновляется при каждом обновлении данных за этот день на основе expression указанного для *study* к группе которого привязан пользователь, если пользователь не привязан ни к одному *study*, то RS не может быть расчитан. Эти значения RS используются при расчете среднего RS для Intervention (для корректного отображения должнен быть выбран период охватывающий все интервеншены).


Group View
----------

Страница Group view содержит список всех пользоватеелй группы study, с агригированными данными интервеншенов и индивидуальными целями пользователя. 
 
.. image:: /_static/Images/Figure_12.png
   :target: ../../_static/Images/Figure_12.png

1. элемент для выбора выбор группы
2. ссылка на редактировнаие группы
3. сссылка на управление всеми группами Study к которой привязана группа
4. ссылка на редактирование Study к которой привязана группа
5. поиск по таблице с данными
6. колона таблицы с именем пользователся, так же является ссылкой на страницу Participant view
7. уникальный идентификатор пользователя, устанавливается на странице редактирования пользователя, может быть пустым
8. колонка указывающая список всех типов интервеншенов с количеством интервеншенов каждого типа, учитываются только интервеншены которые были созданы когда пользователь находился в текущем study.
9. колонка указывающая список всех типов интервеншенов с средним RS для каждого типа, учитываются только интервеншены которые были созданы когда пользователь находился в текущем study. Данные должны соответсвовать данным на странице Study Coordinator View (должен быть выбран период охватывающий все интервеншены)
10. колонка отображающая индивидуальные цели пользователя, а также эллементы управления ими
11. указывает текущие цели пользователя по калориям и активности
12. указывает источник целей (индивидуальные или Study)
13. элемнт для вызова меню управления индивидуальными целями


.. image:: /_static/Images/Figure_13.png
   :target: ../../_static/Images/Figure_13.png

*Окно управления индивидуальными целями* 

1. индивидуальная цель по калориям, если не уставнолена 0
2. цель по калориям соответсвующая цели по калориям Study в группе оторого состоит пользователь
3. цель  по калориям полученная от фитбит, может менятся более 10 раз за день подробнее можно почитать на странице фитбит (ссылка)
4. попытка принудительного получения цели по калориям от фитбит
5. выбор типа цели по калориям который будет использоваться для пользователя
6. индивидуальная цель по шагам, если не уставнолена 0
7. выбор типа цели который по шагам будет использоваться для пользователя; индивидуальная цель по минутам активности, если не уставнолена 0
8. выбор типа цели  по минутам активности  который будет использоваться для пользователя
9. сохранить изменения
 
